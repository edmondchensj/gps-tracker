<div class="my-2 mx-2">
    <form>
        <h2>Sign in</h2>
    
        <input type="text" id="inputUsername"  placeholder="Email address" name="username" required autofocus>
        <input type="password" id="inputPassword"  placeholder="Password" name="password" required>    
        <button type="button" onclick="signInButton()">Sign in</button>

    </form>
</div>


<script type="module">
    import { setInnerHTMLWithJS } from "./js/utils.js"
    window.signInButton = function() {
    
	var authenticationData = {
        Username : document.getElementById("inputUsername").value,
        Password : document.getElementById("inputPassword").value,
    };
	
    var authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails(authenticationData);
    
	var poolData = {
        UserPoolId : _config.cognito.userPoolId, // Your user pool id here
        ClientId : _config.cognito.clientId, // Your client id here
    };
	
    var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
	
    var userData = {
        Username : document.getElementById("inputUsername").value,
        Pool : userPool,
    };
	
    var cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
    
	cognitoUser.authenticateUser(authenticationDetails, {
        onSuccess: async function (result) {
			var accessToken = result.getAccessToken().getJwtToken();
			console.log(accessToken);	
            console.log("User authenticated. Logging in...")
            const html = await fetch("/pages/select-bus.html").then((data) => data.text());
            const main = document.getElementById("main");
            setInnerHTMLWithJS(main, html);
        },

        onFailure: function(err) {
            alert(err.message || JSON.stringify(err));
        },
    });
  }
</script>